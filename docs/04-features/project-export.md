# プロジェクト単位エクスポート&インポート機能（2025年6月実装完了） 📦

## 実装概要
プロジェクト全体（プロジェクト情報 + 関連する全設計書）を一括でエクスポート・インポートする機能を実装。バックアップ、共有、環境間移行を効率化し、チーム開発とプロジェクト管理を大幅に向上。

## 実装済み機能

### 1. プロジェクト単位エクスポート機能
- **操作場所**: プロジェクト一覧画面の「プロジェクト管理」メニュー
- **エクスポート対象**: 指定プロジェクト + 関連する全設計書の完全データ
- **出力形式**: `{プロジェクト名}_export.json`
- **データ構造**: 
  ```typescript
  interface ProjectExportData {
    project: Project;              // プロジェクト情報
    documents: Document[];         // 関連する全設計書
    exportedAt: string;           // エクスポート日時
    version: string;              // データフォーマットバージョン
  }
  ```

### 2. プロジェクト単位インポート機能
- **操作方法**: 「プロジェクトインポート」からJSONファイル選択
- **復元内容**: プロジェクト + 設計書の**完全復元**
- **競合対応**: 同名プロジェクト存在時の上書き確認ダイアログ
- **データ整合性**: 新しいプロジェクトIDへの設計書関連付け

### 3. 完全復元対応データ
**画面設計書:**
- ✅ conditions (表示条件 Markdown)
- ✅ supplement (補足説明 Markdown)
- ✅ spreadsheet (項目定義 Fortune-Sheet形式)
- ✅ mockup (画面イメージ Base64)

**データモデル設計書:**
- ✅ supplement (補足説明 Markdown)
- ✅ mermaidCode (Mermaid ER図コード)

**共通メタデータ:**
- ✅ プロジェクト情報（名前、説明、作成日時）
- ✅ 設計書情報（名前、タイプ、作成日時、更新日時）

## 技術的実装

### アーキテクチャ構成
```
src/hooks/
├── useProjectOperations.ts    # プロジェクト操作専用フック
└── useAppState.ts             # アプリケーション状態管理（拡張済み）

src/components/Project/
└── ProjectListView.tsx        # UI拡張（プロジェクト管理メニュー）

src/utils/
└── storage.ts                 # createDocument関数拡張（mermaidCode対応）
```

### 主要実装ファイル

**useProjectOperations.ts**
- **handleProjectExport**: プロジェクト + 関連設計書の一括JSON出力
- **handleProjectImport**: JSONファイルからの完全復元処理
- **競合解決**: 同名プロジェクト検知・上書き確認

**ProjectListView.tsx**
- **プロジェクト管理メニュー**: ドロップダウン形式のUI
- **エクスポート選択**: プロジェクト別のエクスポートボタン
- **インポート機能**: ファイル選択による即座インポート

**storage.ts (createDocument関数拡張)**
```typescript
export function createDocument(
  name: string,
  projectId: string,
  type: DocumentType = 'screen',
  conditions = '',
  supplement = '',
  spreadsheet = null,
  mockup: string | null = null,
  mermaidCode = ''  // 🆕 Mermaid ER図コード対応
): Document
```

## UI/UX設計

### 視覚的設計
- **プロジェクト管理ボタン**: 紫色（#9333ea）で識別しやすい配色
- **ドロップダウンメニュー**: 白背景・影付きで視認性向上
- **操作分離**: インポート（上部）・エクスポート（下部）の明確な区分
- **外部クリック**: メニュー外クリックで自動閉鎖

### UX最適化
- **直感的操作**: 「プロジェクト管理」から全操作にアクセス
- **安全性**: 上書き確認ダイアログによる誤操作防止
- **フィードバック**: 処理完了時の詳細レポート表示
- **エラー処理**: 不正ファイル・破損データの適切なハンドリング

## 使用方法

### エクスポート手順
1. プロジェクト一覧画面を開く
2. 「プロジェクト管理」ボタンをクリック
3. 「プロジェクトエクスポート」から対象プロジェクトを選択
4. `{プロジェクト名}_export.json` ファイルがダウンロード

### インポート手順
1. プロジェクト一覧画面を開く
2. 「プロジェクト管理」ボタンをクリック
3. 「プロジェクトインポート」をクリック
4. エクスポートしたJSONファイルを選択
5. 同名プロジェクト存在時は上書き確認
6. プロジェクト + 設計書が完全復元

## 実用価値

### 1. 企業利用での恩恵
- **プロジェクトバックアップ**: 重要な設計資産の安全な保管
- **環境間移行**: 開発→ステージング→本番への確実な移行
- **チーム協業**: プロジェクト全体の効率的な共有・引き継ぎ
- **災害復旧**: データ損失時の迅速な復元

### 2. 開発効率の向上
- **作業継続性**: 環境変更時の作業中断最小化
- **設計資産の再利用**: 類似プロジェクトでのテンプレート活用
- **品質保証**: 設計内容の完全性担保

### 3. 拡張性の確保
- **将来対応**: 新しい設計書タイプの自動対応
- **データフォーマット**: バージョン管理による互換性維持
- **カスタマイズ**: 企業固有要件への柔軟な対応

## 技術仕様詳細

### データフロー
```
エクスポート: Project + Documents → JSON変換 → ファイルダウンロード
インポート: JSONファイル → 解析・検証 → AppState直接更新 → 完全復元
```

### エラーハンドリング
- **ファイル形式チェック**: JSON以外のファイル拒否
- **データ検証**: 必須フィールド・構造の整合性確認
- **破損データ対応**: 部分的な復元・警告表示
- **競合解決**: ユーザー選択による上書き制御