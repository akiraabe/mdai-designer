# トラブルシューティング・既知問題

## 未解決の既知問題

### JSON読み込み（Retrieve）の不安定性
**現象**: 読み込みボタンでJSONファイルを読み込んだ時、ワークシートが更新される場合とされない場合がある

**調査状況**: 
- テストデータボタンは安定して動作
- 保存機能は正常に動作
- 問題は読み込み処理の複雑なデータ変換ロジックに起因する可能性が高い

**要調査ポイント**:
- `handleLoad`関数内のdata→celldata変換処理
- シート名の一致・不一致によるキー更新タイミング
- 読み込み時のデータ検証・正規化処理

**回避策**: 読み込み失敗時はページリロード後に再試行

## React開発での典型的問題とその対策

### 無限レンダリングループ問題
**原因**: 複雑な`useMemo`/`useCallback`の依存配列による無限ループ
**解決策**: 最適化を排除し、シンプルな直接実装に変更
**学習**: 複雑な最適化より確実な動作を優先

### Reactフックス順序エラー
**原因**: 条件分岐内での`useRef`定義
**解決策**: 全てのフックをコンポーネント先頭で定義
**学習**: フックの順序安定性の重要性

## SpreadsheetEditor関連問題

### データ更新問題の対策パターン
1. **チカチカ問題**: keyプロパティは絶対に固定化
2. **シート名問題**: データ内容も含めたキー生成で確実な更新を保証
3. **フォーカス問題**: 編集モード・表示モード切り替えによる解決

詳細は [Fortune-Sheet機能ドキュメント](./04-features/fortune-sheet.md) を参照

## Mermaidライブラリ関連問題

### エラー通知の完全排除
**問題**: ブランクシートでも画面左下に爆弾アイコン付きエラーが重複表示
**解決策**: 3段階防御による根本的解決
1. Mermaidライブラリ設定最適化
2. グローバルエラーハンドラー無力化
3. DOM要素の物理的削除

詳細は [MermaidEditor改善ドキュメント](./04-features/mermaid-editor.md) を参照

## 開発時のデバッグ手法

### Alert表示による段階的デバッグ
- React開発での典型的問題パターンの理解
- ユーザビリティ重視の解決策選択
- 段階的実装による問題の早期発見

### コンソールログの活用
- 適切なデバッグログの出力
- 処理フローの可視化
- エラー箇所の特定

## 一般的なトラブルシューティング手順

### 開発環境の問題
1. `npm install` で依存関係を再インストール
2. `npm run dev` でサーバー再起動
3. ブラウザキャッシュの削除

### データ関連の問題
1. LocalStorageの内容確認
2. JSONファイルの構造検証
3. バックアップからの復元

### UI/UX関連の問題
1. ブラウザの開発者ツールでの検証
2. コンソールエラーの確認
3. ネットワークタブでのリクエスト確認